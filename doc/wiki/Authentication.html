<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<style type='text/css'>
/*/*/ /*<![CDATA[*/
@import "file://G:/materials/Programming/SVNWorkspace/wiki/wpsrc/main.css";
#quickbar { position: absolute; left: 4px; }
#article { margin-left: 4px; margin-top: 4px; margin-right: 4px; }
a.new, #quickbar a.new { color: #CC2200; }

/*]]>*/ /* */
</style>
</head>
<body bgcolor='#FFFFFF' onload=''>
<div id="content">
<div id='article'>

<a name="Authentication_manager" id="Authentication_manager"></a>
<h2> Authentication manager </h2><p>When an anonymous access to a repository is not permitted, a server asks for authentication credentials. For these 
purposes <b>JavaSVN</b> uses authentication managers. Such managers implement the 
<span class="nobr"><a href="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/auth/ISVNAuthenticationManager.html" class="external" title="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/auth/ISVNAuthenticationManager.html">ISVNAuthenticationManager</a></span> 
interface. The article <a href="Getting_Started_With_JavaSVN.html">Getting Started With JavaSVN</a> describes how to create an <span class="nobr"><a href="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/io/SVNRepository.html" class="external" title="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/io/SVNRepository.html">SVNRepository</a></span> 
driver for working with a repository. After such a driver has been instantiated you provide an authentication manager 
in the following way:

</p><div class="java"><pre>
       <b><font color="#7F0055">try</font></b> &#123;
            ...
            
            ISVNAuthenticationManager authManager;
            
            ...

            SVNURL url = SVNURL.parseURIDecoded(<font color="#2A00FF">&#34;svn://host/path_to_repository_root/inner_path&#34;</font>);
            SVNRepository repository = SVNRepositoryFactory.create(url, <b><font color="#7F0055">null</font></b>);

            <font color="#3F7F5F">//set an auth manager which will provide user credentials
</font>            repository.setAuthenticationManager(basicAuthManager);
            
            ...
            
       &#125; <b><font color="#7F0055">catch</font></b> (SVNException e) &#123;
            <font color="#3F7F5F">//handle exception       		
</font>       &#125;
</pre></div><p>If you don&#39;t provide an authentication manager and a server does not reject anonymous requests (for example, a server 
can be world-readable, and you are performing a checkout) everything should go well. But if it&#39;s not so and the server 
challenges you for credentials, you will certainly get an exception since there&#39;s no authentication manager provided.

</p><a name="Authentication_manager_usage" id="Authentication_manager_usage"></a>
<h3> Authentication manager usage </h3><p>The whole authentication manager is based on the following four logical blocks:
</p><p><br />
<img src="AuthManager_Architecture.png">
<br />
</p><p>On the diagram each logical block is followed by a corresponding interface (in a bold font) provided within the <span class="nobr"><a href="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/auth/package-summary.html" class="external" title="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/auth/package-summary.html">auth package</a></span>.
These blokcs are like pinions of a gear, in our case - of an authentication gear that is used within <b>JavaSVN</b>. Such a 
structure allows you to replace different blocks while the authentication manager itself remaining the same. Let&#39;s look 
at those blocks closer.
</p>
<a name="Authentication_Provider" id="Authentication_Provider"></a>
<h4> Authentication Provider </h4><p>This block is represented by the <span class="nobr"><a href="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/auth/ISVNAuthenticationProvider.html" class="external" title="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/auth/ISVNAuthenticationProvider.html">ISVNAuthenticationProvider</a></span> 
interface in <b>JavaSVN</b> authentication API. It&#39;s responsible for providing <span class="nobr"><a href="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/auth/SVNAuthentication.html" class="external" title="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/auth/SVNAuthentication.html">user authentication credentials</a></span> 
of different kinds. Such providers are passed to an authentication manager. Let&#39;s look at how JavaSVN acts when it receives a server 
challenge for authentication.

</p><p>
Imagine that a client is performing a commit request. The first phase - <b>JavaSVN</b> sends the request to the server:
</p><p><br />
<img src="AuthProvider_In_Work1.png">
<br />
</p><p>The server answers with a challenge for authentication:
</p><p><br />
<img src="AuthProvider_In_Work2.png">
<br />
</p><p>At this moment <b>JavaSVN</b> asks the authentication manager provided by the client for the first credentials. Here 
we assume that this is the first time credentials are requested, and since there can be probably more than one credentials for 
the same authentication realm, <b>JavaSVN</b> starts with the first credentials:
</p><p><br />
<img src="AuthProvider_In_Work3.png">
<br />
</p><p>The authentication manager in turn invokes the authentication provider asking for the first credentials:
</p><p><br />
<img src="AuthProvider_In_Work4.png">
<br />
</p><p>In the previous diagram the last <i>null</i> parameter says that we are fetching the first credentials and do not 
have any previous ones.
Surely, this diagram is a bit relative: authentication manager is also a part of <b>JavaSVN</b>, but is shown outside 
the <b>JavaSVN</b> bubble only for more clear demonstration. Method signatures are also demonstrative only and do not exactly 
match real methods (although they are quite similar). 
</p><p>
</p><p>
An authentication provider may be implemented to prompt a user for credentials, for example, when the user tries 
to authorize himself with <i>name:password</i> credentials (credentials types are discussed later):
</p><p><br />
<img src="AuthProvider_In_Work5.png">
<br />
</p><p>So, our authentication provider returns the credentials up to the manager, and the manager returns them up to the <b>JavaSVN</b>:
</p><p><br />
<img src="AuthProvider_In_Work6.png">
<br />
</p><p>After this <b>JavaSVN</b> sends the credentials to the server:
</p><p><br />
<img src="AuthProvider_In_Work7.png">
<br />
</p><p>At this point the server may accept the client&#39;s credentials if they are valid, and satisfy the request. <b>JavaSVN</b> 
receives a successful response and marks the current credentials as acknowledged by the server:
</p><p><br />
<img src="AuthProvider_In_Work8.png">
<br />
</p><p>But imagine, that the user misprinted his password, and the server rejects wrong credentials:
</p><p><br />
<img src="AuthProvider_In_Work9.png">
<br />
</p>

   

</div>
</div>
</body>
</html>