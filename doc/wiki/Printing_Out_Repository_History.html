<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<style type='text/css'>
/*/*/ /*<![CDATA[*/
@import "file://G:/materials/Programming/SVNWorkspace/wiki/wpsrc/main.css";
#quickbar { position: absolute; left: 4px; }
#article { margin-left: 4px; margin-top: 4px; margin-right: 4px; }
a.new, #quickbar a.new { color: #CC2200; }

/*]]>*/ /* */
</style>
</head>
<body bgcolor='#FFFFFF' onload=''>
<div id="content">
<div id='article'>

<p><a href="Printing_Out_File_Contents.html"><<</a> | <a href="Managing_repository_With_JavaSVN.html">List</a> |  <a href="Editing_operation_Commit.html">>></a>
<br />
<br />
</p>
<a name="Getting_A_Repository_History" id="Getting_A_Repository_History"></a>
<h2> Getting A Repository History </h2><p>In this example we&#39;ll demonstarte how you may get the history of changes made to a repository (i.e perform a log 
operation) starting with the very first revision and up to the very last one. 

</p><div class="java"><pre>
...

<b><font color="#7F0055">public</font></b> <b><font color="#7F0055">class</font></b> History &#123;

    <b><font color="#7F0055">public</font></b> <b><font color="#7F0055">static</font></b> <b><font color="#7F0055">void</font></b> main(String&#91;&#93; args) &#123;
        DAVRepositoryFactory.setup();

        String url = <font color="#2A00FF">&#34;http://svn.tmate.org:8080/svn/jsvn/trunk/doc&#34;</font>;
        String name = <font color="#2A00FF">&#34;anonymous&#34;</font>;
        String password = <font color="#2A00FF">&#34;anonymous&#34;</font>;
        <b><font color="#7F0055">long</font></b> startRevision = 0;
        <b><font color="#7F0055">long</font></b> endRevision = &#45;1;<font color="#3F7F5F">//HEAD (the latest) revision
</font>
        SVNRepository repository = <b><font color="#7F0055">null</font></b>;
        <b><font color="#7F0055">try</font></b> &#123;
            repository = SVNRepositoryFactory.create(SVNURL.parseURIEncoded(url));
            ISVNAuthenticationManager authManager = SVNWCUtil.createDefaultAuthenticationManager(name, password);
            repository.setAuthenticationManager(authManager);

            ...
            Collection logEntries = <b><font color="#7F0055">null</font></b>;
            
            logEntries = repository.log(<b><font color="#7F0055">new</font></b> String&#91;&#93; &#123;<font color="#2A00FF">&#34;&#34;</font>&#125;, <b><font color="#7F0055">null</font></b>, startRevision, endRevision, <b><font color="#7F0055">true</font></b>, <b><font color="#7F0055">true</font></b>);
            ...
</pre></div><p>We don&#39;t use paths to get only those revisions where paths were changed, so we pass an empty array 
<code>new String[] {&quot;&quot;}</code> to the <code>log(...)</code> method of the repository access driver. 
</p><p>
</p><p>
The second 
parameter is a Collection to receive history objects. Information about each revision is represented by a single 
<span class="nobr"><a href="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/SVNLogEntry.html" class="external" title="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/SVNLogEntry.html">SVNLogEntry</a></span> object. We pass <code>null</code> 
since we don&#39;t need to fill an existing collection with history objects. 
</p><p>
</p><p>
Then we pass a range of revisions for which 
the history of changes to be fetched out. 
</p><p>
</p><p>
The fifth parameter controls whether information of all changed paths per 
revision should be included into histroy objects. Such information is represented by an 
<span class="nobr"><a href="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/SVNLogEntryPath.html" class="external" title="http://tmate.org/svn/kb/javadoc/org/tmatesoft/svn/core/SVNLogEntryPath.html">SVNLogEntryPath</a></span> object for each revision.
We are going to print out all changed paths, so setting it to <code>true</code>. 
</p><p>
</p><p>
And the last parameter stricts node&#39;s history only to the node itself, what means that history of the node&#39;s ancestor 
(if the node has been copied) won&#39;t be included. 
</p><p>
</p><p>
Now let&#39;s print the collected information:

</p><div class="java"><pre>
        ...      
        <b><font color="#7F0055">for</font></b> (Iterator entries = logEntries.iterator(); entries.hasNext();) &#123;
            SVNLogEntry logEntry = (SVNLogEntry) entries.next();
            System.out.println(<font color="#2A00FF">&#34;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#45;&#34;</font>);
            System.out.println(<font color="#2A00FF">&#34;revision: &#34;</font> + logEntry.getRevision());
            System.out.println(<font color="#2A00FF">&#34;author: &#34;</font> + logEntry.getAuthor());
            System.out.println(<font color="#2A00FF">&#34;date: &#34;</font> + logEntry.getDate());
            System.out.println(<font color="#2A00FF">&#34;log message: &#34;</font> + logEntry.getMessage());

            <b><font color="#7F0055">if</font></b> (logEntry.getChangedPaths().size() &#62; 0) &#123;
                System.out.println();
                System.out.println(<font color="#2A00FF">&#34;changed paths:&#34;</font>);
                Set changedPathsSet = logEntry.getChangedPaths().keySet();

                <b><font color="#7F0055">for</font></b> (Iterator changedPaths = changedPathsSet.iterator(); changedPaths.hasNext();) &#123;
                    SVNLogEntryPath entryPath = (SVNLogEntryPath) logEntry.getChangedPaths().get(changedPaths.next());
                    System.out.println(<font color="#2A00FF">&#34; &#34;</font>
                            + entryPath.getType()
                            + <font color="#2A00FF">&#34;	&#34;</font>
                            + entryPath.getPath()
                            + ((entryPath.getCopyPath() != <b><font color="#7F0055">null</font></b>) ? <font color="#2A00FF">&#34; (from &#34;</font>
                                    + entryPath.getCopyPath() + <font color="#2A00FF">&#34; revision &#34;</font>
                                    + entryPath.getCopyRevision() + <font color="#2A00FF">&#34;)&#34;</font> : <font color="#2A00FF">&#34;&#34;</font>));
                &#125;
            &#125;
        &#125;
        ...
    &#125;
&#125;
</pre></div><p>And finally we run the program and have the following output in our console:
</p><pre> ---------------------------------------------
 revision: 1240
 author: alex
 date: Tue Aug 02 19:52:49 NOVST 2005
 log message: 0.9.0 is now trunk

 changed paths:
  A	/trunk (from /branches/0.9.0 revision 1239)
 ---------------------------------------------
 revision: 1263
 author: sa
 date: Wed Aug 03 21:19:55 NOVST 2005
 log message: updated examples, javadoc files
 
 changed paths:
  M	/trunk/doc/javadoc-files/javadoc.css
  M	/trunk/doc/javadoc-files/overview.html
  M	/trunk/doc/examples/src/org/tmatesoft/svn/examples/wc/StatusHandler.java
 ---------------------------------------------
 revision: 1287
 author: sa
 date: Mon Aug 08 18:27:37 NOVST 2005
 log message: modified javadoc.css, packages overview
 
 changed paths:
  M	/trunk/doc/javadoc-files/javadoc.css
  M	/trunk/doc/javadoc-files/overview.html
  D	/trunk/doc/javadoc-files/subversion.png
  A	/trunk/doc/javadoc-files/info.png
 ---------------------------------------------
 revision: 1294
 author: sa
 date: Tue Aug 09 02:46:29 NOVST 2005
 log message: corrected wc examples, modified javadoc files</pre><hr/><p>Download the <span class="nobr"><a href="http://svn.tmate.org/repos/jsvn/trunk/doc/examples/src/org/tmatesoft/svn/examples/repository/DisplayFile.java" class="external" title="http://svn.tmate.org/repos/jsvn/trunk/doc/examples/src/org/tmatesoft/svn/examples/repository/DisplayFile.java">example program source code</a></span>.
</p><p><br />
<br />
<a href="Printing_Out_File_Contents.html"><<</a> | <a href="Managing_repository_With_JavaSVN.html">List</a> |  <a href="Editing_operation_Commit.html">>></a>

</p>   

</div>
</div>
</body>
</html>